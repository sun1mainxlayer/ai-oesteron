<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Osteron - Istarc's </title>

</head>
<body>


  <h1>Osteron</h1>
  <!--Font name: Orbitron-->
  <div class="whole">
<div class="inbox" id="container">

<div class="chatbox" id="chatbox">
  <div class="message bot-message">Hey there! I am an Ai assistant of ISTARC. I am here to help in education and help you exploring topics of science</div>
  
</div>
<div class="chatbutton">
  <button title="Click to save the current chat History!" id="saveChat" onclick="saveChat()">Save Chat</button>
  <button title="Click to delete the current chat History." id="clearChat" onclick="clearChat()">Clear Chat</button>
  </div>
  
  </div>

<div class="input_handler">
<div class="input_box">
  <textarea 
      id="text_catcher" 
      placeholder="Ask a question..." 
      rows="2"
      onkeydown="handleEnter(event)"></textarea>

  <button class="input-area button" onclick="sendMessage()" id="sendButton" title="Send">➤</button>
</div>
</div>
</div>





  <div class="container">
    <div class="socials">
      <a href="https://istarc.org/new/index.php">Home</a>
      <a href="https://istarc.org/new/about.html">About</a>
      <a href="https://istarc.org/new/articles.php">Articles</a>
      <a href="https://istarc.org/new/gallery.php">Gallery</a>
      <a href="https://istarc.org/new/events.php">Events</a>
      <a href="https://istarc.org/new/contact.php">Contact</a>
    </div>

    <div class="footer">
      &copy; Copyright - ISTARC || Developed by ISTARC IT team
    </div>
  </div>
</body>

<style>
  @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@500&display=swap');

  @import url('https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100..900;1,100..900&display=swap');

  * {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
  }

  body {
    background: linear-gradient(135deg, #0f0f0f, #1a1a1a);
    height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
    text-align: center;
    overflow: hidden;
  }

 .container{
  margin-top: 0.5rem;
  position: fixed;
  bottom: 0.7rem;
 }

  h1 {
    font-size: 2.5rem;
    text-shadow: 0 0 5px #10b6bc;
    position: fixed;
    top: 1.5vw;;
    left: 1.5vw;
    font-family: 'Orbitron';
    color:#00f7ff

  }

  .inbox{
    height: 35vw;
    width: 83vw;
    background-color: rgb(65, 63, 63);
    margin-bottom: 0.5rem;
    border: 1px solid transparent;
    border-radius: 25px;
  }


  .chatbox{
    height: 30vw;
    width: auto;
    background-color: rgb(65, 63, 63);
    border: 1px solid transparent;
    border-radius: 25px;
    padding: 1rem 1rem;
    display: flex; 
    flex-direction: column; 
    overflow-y: scroll;
    overflow-x: hidden;
    margin-right: 0.5rem;
    padding: 2rem 2rem;

  }::-webkit-scrollbar{
    
    border: 1px solid transparent;
    border-top-right-radius: 25px;
    border-bottom-right-radius: 25px;
    width: 0.8rem;
    padding-right: 0.3rem;
    
  }::-webkit-scrollbar-thumb{
    background-color: rgb(28, 28, 28);       
    border-radius: 10px;         
    border: 1px solid transparent; 
    background-clip: padding-box;
    cursor: pointer;
  }

  
.input_handler{
  display: flex;
  align-items: center;
  justify-content: center;
  width: 100%;
  margin-top: 1rem;
}
  
.input_box{
  margin-top: 1.5rem;
  display: flex;
  align-items: flex-end;
  width: 70%;
  
  border: 1px solid transparent;
  outline: none;
  resize: none;
  border-radius: 25px;
  padding: 1rem 1rem;
  box-shadow: 0 25px 20px rgba(0,0,0,0.5);
  background-color: rgb(66, 67, 68);
  font-size: 0.9rem;
  line-height: 1.4;
  overflow-y: scroll;
  
  
}


#typing-indicator { 
  
  color: rgb(255, 255, 255);
  font-size: 1.5rem; 
  text-align: left;
  margin-bottom: 10px; 
  display: none; 
  animation: appear 1.1s ease-in-out infinite;
 
}

@keyframes appear{
  0%{ opacity: 0;}
  100%{ opacity: 1;}
}

#text_catcher{
  flex: 1;
  border: none;
  background: transparent;
  outline: none;
  resize: none;
  height: auto;
  max-height: 150px; 
  overflow-y: hidden;
  font-family: sans-serif;
  font-size: 16px;
  line-height: 1.4;
  padding: 0;
  margin: 0.1rem 0.1rem;
  color: #fff;
  overflow-y: scroll;
}

#text_catcher::-webkit-scrollbar-thumb{
  cursor: pointer;
}

#text_catcher:focus{
  outline: none;
  
}

.input_box>button{
  height: 3rem;
  width: 3rem;
  margin-left: 0.5rem;
  border: 1px solid transparent;
  background-color: rgb(255, 255, 255);
  text-decoration: none;
  font-family: 'Roboto', 'Lucida Sans', 'Lucida Sans Regular', 'Lucida Grande', 'Lucida Sans Unicode', Geneva, Verdana, sans-serif;
  border-top-right-radius: 25px;
  font-size: 1.5rem;
  font-weight: bold;
  border-radius: 25px;
  padding: 0;
  color:#000;
  box-shadow: 0px 5px 15px rgba(0,0,0,0.5);

}

.input_box>button:disabled{
  background-color: rgb(197, 194, 194);
}

.chatbutton{
  margin-top: 0.5rem;
  margin-bottom: 0.5rem;
  height: 1.5rem;
}

.chatbutton>button{
  height: 1.5rem;
  width: 5rem;
  border: 1px solid transparent;
  border-radius: 20px;
  color: #fff;
  background: rgb(12, 163, 12);
  margin-right: 1rem;
  cursor:pointer;
}

#clearChat{
  background: rgb(171, 23, 23);
}

.message{
  margin-bottom: 15px; 
  padding: 15px 15px; 
  border-radius: 20px; 
  width: fit-content;
  line-height: 1.4; 
  font-size: 1rem;
  font-family: 'Roboto';
}

.bot-message{
  background: transparent;
  color: rgb(225, 213, 213); 
  align-self: flex-start; 
  text-align: left;
  justify-content: right;
  margin-right: auto; 
  border-bottom-left-radius: 2px; 
  max-width: 80%;
}

/*For chat-bot message decoration*/
.bot-message strong {
    color: #0b57d0;
    font-weight: 700;
}

/* Headings */
.bot-message h2, .bot-message h3 {
    margin-top: 15px;
    margin-bottom: 8px;
    font-size: 17px;
    color: #1f1f1f;
    font-weight: 600;
}

/* Bullet Points */
.bot-message ul, .bot-message ol {
    margin-left: 20px;
    margin-bottom: 10px;
}

.bot-message li {
    margin-bottom: 5px;
}

/* Code Blocks  */
.bot-message pre {
    background: #1e1e1e; 
    color: #d4d4d4;
    padding: 15px;
    border-radius: 8px;
    overflow-x: auto; 
    font-family: 'Consolas', 'Monaco', monospace;
    font-size: 13px;
    margin: 10px 0;
}

/* Inline Code  */
.bot-message code {
    background: #f0f4f9;
    padding: 2px 6px;
    border-radius: 4px;
    font-family: monospace;
    color: #c7254e;
}

/* Table :) */
.bot-message table {
    width: 100%;
    border-collapse: collapse;
    margin: 10px 0;
    font-size: 14px;
}

.bot-message th, .bot-message td {
    border: 1px solid #ddd;
    padding: 8px;
    text-align: left;
}

.bot-message th {
    background-color: #f2f2f2;
    font-weight: bold;
}
/*For chat-bot message decoration*/


.user-message { 
  background:  rgb(79, 76, 76); 
  color: white; 
  align-self: flex-end;
  text-align: left;
  max-width: 40%;
 }

  .socials {
    display: flex;
    justify-content: center;
    gap: 15px;
    margin-top: 30px;
    flex-wrap: wrap;
    word-break: break-word;
    text-align: center;
  }

  .socials a {
    color: #00f7ff;
    font-size: 1vw;
    text-decoration: none;
    transition: color 0.3s ease;
    min-width: 60px;
    display: inline-block;
    font-family: 'Orbitron', 'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS', sans-serif;
  }

  .socials a:hover {
    color: white;
  }

  .footer {
    font-size: 0.8rem;
    color: #888;
    margin-top: 40px;
    font-family: 'Orbitron', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
  }



    .socials {
      gap: 10px;
    }

    .socials a {
      font-size: 0.9rem;
      min-width: auto;
      margin-right: 1rem;
    }
  
</style>
<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
<script>

  var container = document.getElementById('container');
  var body = window.screen.width;


if (body <= 680) {
  container.style.height = "25rem";
  container.style.marginTop = "0rem";
}
else{
  container.style.height = "30vw";
}

function autoResize() {
  var textarea = document.getElementById("text_catcher");
   
    textarea.style.height = 'auto'; 
    
    
    textarea.style.height = textarea.scrollHeight + 'px';
}

autoResize();


const BACKEND_URL = "https://sun1mainxlayer.github.io/ai-backened/chat";


window.onload = function() {
    const savedChat = localStorage.getItem("chatHistory");
    if (savedChat) {
        document.getElementById("chatbox").innerHTML = savedChat;
        const chatBox = document.getElementById("chatbox");
        chatBox.scrollTop = chatBox.scrollHeight;
    }
};

async function sendMessage() {
    const inputField = document.getElementById("text_catcher");
    const chatBox = document.getElementById("chatbox");
    const message = inputField.value.trim();
    const sendButton = document.getElementById("sendButton");
    

    
    if (!message) return;

    
    

    inputField.value = '';
    chatBox.innerHTML += `<div class="message user-message">${message}</div>`;
    chatBox.innerHTML += `<div id="typing-indicator">⚫</div> `;

    


    inputField.disabled = true;
    sendButton.disabled = true;

    
    chatBox.scrollTop = chatBox.scrollHeight;

    var typing = document.getElementById("typing-indicator");
    

    try {
        const response = await fetch(BACKEND_URL, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ message: message })
        });

        if (response.status === 429) {
            chatBox.innerHTML += `<div class="message bot-message" style="background:#ffd1d1; color:#a80000;">⚠️ Too many requests. Wait a moment.</div>`;
        } else {
            const data = await response.json();
            const formattedReply = marked.parse(data.reply);
            chatBox.innerHTML += `<div class="message bot-message">${formattedReply}</div>`;
        }
        

    } catch (error) {
        chatBox.innerHTML += `<div class="message bot-message" style="color:red">Error connecting to server. Please try again later or contact to ISTARC's IT dept.</div>`;
    } finally {
        
        inputField.disabled = false;
        sendButton.disabled = false;
      if(typing){
        typing.style.display = "none";
      }
       
       chatBox.scrollTop = chatBox.scrollHeight;
       inputField.focus();

    }
}

function handleEnter(event) {
   
    if (event.key === "Enter" && !event.shiftKey) {
        
        event.preventDefault(); 
        
        sendMessage();
        

    }
   
}


function saveChat() {
    const chatContent = document.getElementById("chatbox").innerHTML;
    localStorage.setItem("chatHistory", chatContent);
    alert("Chat saved successfully!")
}


function clearChat() {
    if(confirm("Are you sure you want to delete this chat?")) {
        localStorage.removeItem("chatHistory");
        document.getElementById("chatbox").innerHTML = '<div class="message bot-message">Chat cleared! Start a new topic.</div>';
    }
}


function downloadChat() {
    const messages = document.querySelectorAll('.message');
    let textContent = "--- Chat Log ---\n\n";

    messages.forEach(msg => {
        
        const sender = msg.classList.contains('user-message') ? "You" : "AI";
       
        textContent += `${sender}: ${msg.innerText}\n\n`;
    });


    const blob = new Blob([textContent], { type: "text/plain" });
    const a = document.createElement("a");
    a.href = URL.createObjectURL(blob);
    a.download = "My_Study_Chat.txt";
    a.click();
}

</script>
</html>
